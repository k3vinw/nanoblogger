<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content="HTML Tidy for MkLinux (vers 1st March 2004), see www.w3.org" />

  <title>NanoBlogger Manual</title>
</head>

<body bgcolor="white">
  <hr />

  <h1>NanoBlogger Manual</h1>

  <h2>by <a href="mailto:un1xt3r_at_fastmail_dot_fm">n1xt3r</a> (Kevin Wood)</h2>
  <hr />
  <em>This document explains how to install and use NanoBlogger.</em><br />
  <br />
  <hr />

  <p><b>Table of Contents</b></p>

  <ul>
    <li><a href="#cr1">Introduction</a></li>

    <li><a href="#cr2">Features</a></li>

    <li><a href="#cr3">Installation</a></li>

    <li><a href="#cr4">Requirements</a></li>

    <li><a href="#cr5">Getting Started</a></li>

    <li><a href="#cr6">Settings and Configuration</a></li>

    <li><a href="#cr7">Templates and Placeholders</a></li>

    <li><a href="#cr8">Plugins</a></li>

    <li><a href="#cr9">Publishing to a Remote Site</a></li>

    <li><a href="#cr10">Tips and Tricks</a></li>

    <li><a href="#cr11">Credits</a></li>
  </ul>

  <h2><a name="cr1" id="cr1">Introduction</a></h2>NanoBlogger is a small weblog engine written in Bash for the command line. It
  uses common unix tools, such as cat, grep and sed. It's free to use and modify under the GNU General Public License.<br />
  <b>Synopsis</b>

  <blockquote>
    <pre>
nb [<u>-b blogdir</u>] [<u>options</u>]
</pre>
  </blockquote>

  <h2><a name="cr2" id="cr2">Features</a></h2>

  <ul>
    <li>intuitive commandline interface</li>

    <li>support for multiple blogs</li>

    <li>easy editing and management of entries</li>

    <li>archiving by month</li>

    <li>category support</li>

    <li>permalinks</li>

    <li>RSS syndication (comes with RSS 1.0 (RDF) format)</li>

    <li>a fully functional web site, using templates and stylesheets for easy customizations</li>

    <li>placeholders for easy template manipulation</li>

    <li>plugins for calendar, recent entries, blog status, fortunes, etc.</li>

    <li>auto-formatting, e.g. line breaks translate to HTML</li>

    <li>keeps "clippings" (parts cut out) of the blog for extra portability and modularity (e.g. news.htm, 2003-06.htm)</li>

    <li>per-blog configuration via a config file (blog.conf)</li>

    <li>no dependency on any javascript, server-side scripting, or server-side includes</li>

    <li>no dependency on any external database (uses flat-file)</li>

    <li>some small effort at shell portability</li>
  </ul>

  <h2><a name="cr3" id="cr3">Installation</a></h2>To install nanoblogger, download the tar archive from the web site[1]. Then
  from the commandline type "tar xzf nanoblogger-XXX.tar.gz where "XXX" equals the version number.<br />

  <p><b>Upgrading</b></p>When upgrading nanoblogger, there's three basic things that need to be considered: archives, templates,
  and configuration. These three things also may require some minor adjustments before they work well with the new version. Here
  are some steps you can take to help ease the transition.

  <ul>
    <li>create a new blog directory using nanoblogger: "nb -b [blog_dir] -a" (skip the configuration)</li>

    <li>copy the old <em>archives</em> (data) directory over to the new blog directory: "cp -r [oldblog_dir]/archives
    [newblog_dir]"</li>

    <li>copy the old <em>templates</em> directory over to the new blog directory: "cp -r [oldblog_dir]/templates
    [newblog_dir]".</li>

    <li>make the required changes (if any) to your templates. Refer to the "Templates and Placeholders" section</li>

    <li>edit the new <em>blog.conf</em> to your likings and rebuild the blog: "nb -b [blog_dir] -u all"</li>
  </ul>

  <h2><a name="cr4" id="cr4">Requirements</a></h2>Programs:

  <blockquote>
    bash, cat, cp, cut, dirname, date, expr, grep, mkdir, mv, read, rm, sed, sort, touch, trap
  </blockquote>

  <h2><a name="cr5" id="cr5">Getting Started</a></h2><b>Creating a New Blog</b>

  <blockquote>
    To create a new blog invoke:
    <pre>
nb --blogdir myblog_dir --add
</pre>where "myblog_dir" is a non-existant directory. This is will create a new directory, copy the default files over, and then
let you edit the blog's configuration. Run the same command again to add another entry.
  </blockquote>

  <h2><a name="cr6" id="cr6">Settings and Configuration</a></h2>To edit the blog's configuration invoke:
  <pre>
nb --blogdir myblog_dir --configure
</pre>This opens <em>blog.conf</em> from the blog directory for editing.<b>Setting the Editor</b>

  <blockquote>
    The editor defaults to the <em>EDITOR</em> variable in your shell's environment, but falls back on vi when no <em>EDITOR</em>
    is set. You can specify a different editor to use by overriding <em>EDITOR</em> in <em>blog.conf</em> or setting the
    <em>EDITOR</em> variable in your shell's environment.
  </blockquote><b>Setting the Date Format for New Entries</b>

  <blockquote>
    <em>DATE_FORMAT</em> controls the look of a new entry's date. The default <em>DATE_FORMAT</em> uses "%B %d, %Y %l:%M %p" and
    produces something like this: "August 05, 2003 12:53 AM". You can also specify the locale to be used for date command (see
    the variable <em>DATE_LOCALE</em>). Please note that this setting has no effect on previous entries. Read the man pages of
    the date command to see more on how to customize the format of the date command's output.
  </blockquote><b>Setting the Web Address</b>

  <blockquote>
    <em>BLOG_URL</em> is used as the address for the blog. Typically, you would set this to a remote address such as:
    "http://myblogurl.com". Replacing <em>myblogurl.com</em> with the actual address to your blog.
  </blockquote><b>Setting the Link for "Main"</b>

  <blockquote>
    <em>BLOG_URL_MAIN</em> is used as the navigational link for "main". The default is set to "$BLOG_URL/index.html", for easier
    local navigation.
  </blockquote><b>Setting the Style Sheet</b>

  <blockquote>
    <em>BLOG_CSS</em> is used as the link to the style sheet in the default set of templates. It provides an easy way to edit or
    switch the style sheet's location without having to edit each template. It should be set in a similar fashion to
    <em>BLOG_URL_MAIN</em>, 'BLOG_CSS="$BLOG_URL/styles/nb_rusted.css"'. Style sheets are located in the <em>styles</em>
    directory.
  </blockquote><b>Setting the Author's Name</b>

  <blockquote>
    <em>BLOG_AUTHOR</em> can be used to set the author's name, the default is to set the author's name using the common USER
    variable. Setting <em>BLOG_AUTHOR</em> will override this behavior.
  </blockquote><b>Setting the Number of Entries to Display</b>

  <blockquote>
    <em>MAX_ENTRIES</em> sets the maximum number of entries that get displayed as current. This must be set to a number higher
    than zero.
  </blockquote><b>Toggling the Display of Permalinks</b>

  <blockquote>
    <em>PERMALINKS</em> toggles display of permalinks along-side an entry. The default is set to "1", display permalinks.
  </blockquote><b>Building Individual Archives for Each Entry</b>

  <blockquote>
    Setting <em>ENTRY_ARCHIVES</em> to equal "1", enables individual archiving of each entry and reconfigures the links of the
    entries to point to their individual archives. Note that this will increase the rebuild time since more pages will have to be
    generated.
  </blockquote><b>Setting Actions for Previewing and Publishing</b>

  <blockquote>
    <em>BLOG_PREVIEW_CMD</em> and <em>BLOG_PUBLISH_CMD</em> may both be set to a custom command to run when invoked by their
    respective options, <em>--preview</em> and <em>--publish</em>.
  </blockquote><b>Global Configuration</b>

  <blockquote>
    NanoBlogger has it's own configuration file, <em>nb.conf</em> that holds settings which effect all blogs. The global
    configuration file is read first meaning that settings in the blog's configuration may override settings in <em>nb.conf</em>.
    Typically one would set <em>BLOG_DIR</em> here as a default blog directory to use. This configuration is also looked for
    under the file, <em>$HOME/.nb.conf</em>.
  </blockquote>

  <h2><a name="cr7" id="cr7">Templates and Placeholders</a></h2>Templates are located in the blog's sub-directory, templates.

  <blockquote>
    <table border="1" cellspacing="4" cellpadding="2" summary="templates">
      <caption>
        The blog's appearance is controlled by the following templates:
      </caption>

      <tr>
        <th align="left">templates</th>

        <th align="left">description</th>
      </tr>

      <tr>
        <td align="left">atom.xml*</td>

        <td align="left">controls look and format of the main atom feed</td>
      </tr>

      <tr>
        <td align="left">atom_entry.xml*</td>

        <td align="left">controls look of the entries in the atom feed</td>
      </tr>

      <tr>
        <td align="left">archive.htm*</td>

        <td align="left">controls look of the master archive page</td>
      </tr>

      <tr>
        <td align="left">archive_links.htm*</td>

        <td align="left">controls look of the master archive links</td>
      </tr>

      <tr>
        <td align="left">category.htm</td>

        <td align="left">controls look of the categories pages</td>
      </tr>

      <tr>
        <td align="left">category_links.htm*</td>

        <td align="left">the links to the categories</td>
      </tr>

      <tr>
        <td align="left">entry.htm</td>

        <td align="left">controls look of your blog entries</td>
      </tr>

      <tr>
        <td align="left">entry_links.htm</td>

        <td align="left">controls look of the entry links</td>
      </tr>

      <tr>
        <td align="left">entrycat_links.htm*</td>

        <td align="left">controls look of the entry category links</td>
      </tr>

      <tr>
        <td align="left">main_index.htm</td>

        <td align="left">controls look of the blog's main page</td>
      </tr>

      <tr>
        <td align="left">main_links.htm*</td>

        <td align="left">contains user defined links</td>
      </tr>

      <tr>
        <td align="left">makepage.htm</td>

        <td align="left">default template used by makepage option</td>
      </tr>

      <tr>
        <td align="left">month_archive.htm</td>

        <td align="left">controls look of the monthly archive pages</td>
      </tr>

      <tr>
        <td align="left">month_links.htm</td>

        <td align="left">controls look of the monthly archive links*</td>
      </tr>

      <tr>
        <td align="left">permalink.htm</td>

        <td align="left">controls look of the permalink pages</td>
      </tr>

      <tr>
        <td align="left">permalink_entry.htm</td>

        <td align="left">controls look of a blog entry within a permalink page</td>
      </tr>

      <tr>
        <td align="left">rdf_catfeed_entry.xml*</td>

        <td align="left">controls look of the news items in a category's rss feed</td>
      </tr>

      <tr>
        <td align="left">rdf_catfeed.xml*</td>

        <td align="left">controls look and format of a category's rss feed</td>
      </tr>

      <tr>
        <td align="left">rdf_entry.xml*</td>

        <td align="left">controls look of the news item in the rss feed</td>
      </tr>

      <tr>
        <td align="left">rdf.xml*</td>

        <td align="left">controls look and format of rss feed</td>
      </tr>
    </table>* = used by plugin
  </blockquote>

  <blockquote>
    <table border="1" cellspacing="4" cellpadding="2" summary="entry placeholders">
      <caption>
        The entry template includes the following placeholders:
      </caption>

      <tr>
        <th align="left">placeholders</th>

        <th align="left">description</th>
      </tr>

      <tr>
        <td align="left">$NB_EntryAuthor</td>

        <td align="left">author of entry</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryCategories*</td>

        <td align="left">entry's category links</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryBody</td>

        <td>entry's content</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryDate</td>

        <td align="left">entry's posted time</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryDescription</td>

        <td align="left">entry's description</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryID</td>

        <td align="left">entry's id</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryPermalink</td>

        <td align="left">entry's permalink</td>
      </tr>

      <tr>
        <td align="left">$NB_EntryTitle</td>

        <td align="left">entry's title</td>
      </tr>
    </table>* = generated by plugin
  </blockquote>

  <blockquote>
    <table border="1" cellspacing="4" cellpadding="2" summary="main placeholders">
      <caption>
        The main template includes the following placeholders:
      </caption>

      <tr>
        <th align="left">placeholders</th>

        <th align="left">description</th>
      </tr>

      <tr>
        <td align="left">$BLOG_CHARSET</td>

        <td align="left">blog's character set</td>
      </tr>

      <tr>
        <td align="left">$BLOG_URL_MAIN</td>

        <td align="left">blog's "main" link</td>
      </tr>

      <tr>
        <td align="left">$BLOG_CONTACT</td>

        <td align="left">blog's contact info</td>
      </tr>

      <tr>
        <td align="left">$BLOG_DESCRIPTION</td>

        <td align="left">blog's description</td>
      </tr>

      <tr>
        <td align="left">$BLOG_TITLE</td>

        <td align="left">blog's title</td>
      </tr>

      <tr>
        <td align="left">$BLOG_URL</td>

        <td align="left">blog's URL</td>
      </tr>

      <tr>
        <td align="left">$NB_Month_Links*</td>

        <td align="left">links to the monthly archives</td>
      </tr>

      <tr>
        <td align="left">$NB_Category_Links*</td>

        <td align="left">links to categories</td>
      </tr>

      <tr>
        <td align="left">$NB_Main_Links*</td>

        <td align="left">user defined links</td>
      </tr>

      <tr>
        <td align="left">$NB_Entries</td>

        <td align="left">all the current entries</td>
      </tr>
    </table>* = generated by plugin
  </blockquote>

  <p><b>Format of an Entry</b></p>The entry format is made up of pieces of metadata. Each piece of metadata is of the format KEY:
  VALUE, then a carriage return that separates one piece from the next. The order of the metadata pieces is not important.

  <p>Example:</p>

  <blockquote>
    TITLE: A New Entry<br />
    AUTHOR: foo<br />
    DATE: January 30 2004, 12:00 PM<br />
    DESC: the description of this entry<br />
    -----<br />
    BODY:<br />
    This is my new entry ...<br />
    -----<br />
  </blockquote>Entries are kept inside the blog's <em>archives</em> directory as time-stamped filenames. NanoBlogger uses the
  filename to determine how to sort the entries into the archives.<br />

  <h2><a name="cr8" id="cr8">Plugins</a></h2>

  <h3>Types of Plugins</h3>

  <blockquote>
    <p><b>Regular Plugins</b></p>

    <blockquote>
      Regular plugins are stored in the plugins directory and are loaded first.
    </blockquote>

    <p><b>Archive Plugins</b></p>

    <blockquote>
      Archive plugins are stored in the plugins/archive directory and are loaded when the archives are built.
    </blockquote>

    <p><b>Monthly Plugins</b></p>

    <blockquote>
      Monthly plugins are stored in plugin/archive/monthly directory and are loaded for each month.
    </blockquote>

    <p><b>Entry Plugins</b></p>

    <blockquote>
      Entry plugins are stored in the plugins/entry directory and are loaded for each entry processed.
    </blockquote>

    <p><b>Postformat Plugins</b></p>

    <blockquote>
      Postformat plugins are stored in the plugins/postformat directory and are loaded after each page generated.
    </blockquote>

  </blockquote>
  
  Plugins typically work by creating placeholders for the templates, but are in no way limited to creating
  placeholders. Placeholders allow for a great deal of control in how the plugins output is placed in the template. The variable,
  <em>ENABLE_PLUGINS</em>, in <em>blog.conf</em> toggles the use of plugins on/off. Create plugins that run specifically for your
  blog by creating a "plugins" directory under a blog's own directory and copying or creating a plugin with the ".sh" extension.
  Some plugins may require you to identify it's unique placeholder/destination and manually add it to your templates.

  <blockquote>
    <table border="1" cellspacing="4" cellpadding="2" summary="plugins">
      <caption>
        The main plugins (most are enabled by default):
      </caption>

      <tr>
        <th align="left">plugins</th>

        <th align="left">description</th>

        <th align="left">variables</th>

        <th align="left">targets</th>

        <th align="left">notes</th>
      </tr>

      <tr>
        <td align="left">archive/master_index.sh</td>

        <td align="left">creates a master index page of the archives</td>

        <td align="left">none</td>

        <td align="left">$BLOG_URL/archives.html</td>

        <td align="left">requires templates</td>
      </tr>

      <tr>
        <td align="left">archive/monthly/monthly_cal.sh</td>

        <td align="left">adds a calendar with links for each active day</td>

        <td align="left">none</td>

        <td align="left">$NB_Monthly_Calendar</td>

        <td align="left">requires cal</td>
      </tr>

      <tr>
        <td align="left">atom.sh</td>

        <td align="left">adds an atom feed</td>

        <td align="left">LIMIT_ITEMS</td>

        <td align="left">$BLOG_URL/atom.$NB_SYND_FILETYPE</td>

        <td align="left">requires templates</td>
      </tr>

      <tr>
        <td align="left">blog_links.sh</td>

        <td align="left">generates some useful links</td>

        <td align="left">none</td>

        <td align="left">$NB_Main_Links, $NB_Month_Links, $NB_Category_Links</td>

        <td align="left">requires templates</td>
      </tr>

      <tr>
        <td align="left">blog_status.sh</td>

        <td align="left">generates some statistics</td>

        <td align="left">none</td>

        <td align="left">$NB_Blog_Status</td>

        <td align="left">none</td>
      </tr>

      <tr>
        <td align="left">calendar.sh</td>

        <td align="left">adds a calendar with links for each active day</td>

        <td align="left">none</td>

        <td align="left">$NB_Calendar</td>

        <td align="left">requires cal</td>
      </tr>

      <tr>
        <td align="left">entry/auto_break.sh</td>

        <td align="left">converts blank lines to html paragraph breaks</td>

        <td align="left">AUTO_FORMAT</td>

        <td align="left">$NB_EntryBody</td>

        <td align="left">none</td>
      </tr>

      <tr>
        <td align="left">entry/moods.sh</td>

        <td align="left">converts mood variables into equivalent images</td>

        <td align="left">AUTO_FORMAT</td>

        <td align="left">$NB_EntryBody</td>

        <td align="left">copy moods directory to blog's directory</td>
      </tr>

      <tr>
        <td align="left">fortune.sh</td>

        <td align="left">generates random quotes</td>

        <td align="left">FORTUNE_FILE</td>

        <td align="left">$NB_Fortune</td>

        <td align="left">requires fortune</td>
      </tr>

      <tr>
        <td align="left">list_entries.sh</td>

        <td align="left">adds links to recent or old entries</td>

        <td align="left">LIST_N, LIST_OFFSET</td>

        <td align="left">$NB_Recent_Entries, $NB_Older_Entries</td>

        <td align="left">none</td>
      </tr>

      <tr>
        <td align="left">mymood.sh</td>

        <td align="left">adds ability to display your mood</td>

        <td align="left">none</td>

        <td align="left">$NB_My_Mood</td>

        <td align="left">copy moods directory to blog's directory</td>
      </tr>

      <tr>
        <td align="left">postformat/tidy.sh</td>

        <td align="left">validates HTML code</td>

        <td align="left">TIDY_ARGS</td>

        <td align="left">$NB_Tidy</td>

        <td align="left">requires tidy</td>
      </tr>

      <tr>
        <td align="left">rss.sh</td>

        <td align="left">adds rss feeds</td>

        <td align="left">LIMIT_ITEMS</td>

        <td align="left">$BLOG_URL/index.$NB_SYND_FILETYPE, $BLOG_URL/$ARCHIVES/cat_n.$NB_SYND_FILETYPE</td>

        <td align="left">requires templates</td>
      </tr>
    </table>To disable a plugin, rename the plugin's extension from ".sh" to ".off".
  </blockquote><br />

  <h2><a name="cr9" id="cr9">Publishing to a Remote Site</a></h2><b>FTP:</b><br />
  Any FTP client should do, but I'd recommend ncftp. Be sure to use recursive mode when uploading your blog directory. e.g. "ftp
  myblog.com, put -r [your_blog_dir]" <b>Other methods:</b><br />
  If you're not limited to FTP, you might want to consider SSH (scp, sftp, etc.), rsync or WebDAV.

  <h2><a name="cr10" id="cr10">Tips and Tricks</a></h2>

  <ul>
    <li>Update your blog quickly with the "--update main" option. This option skips the processing of entries and is great for
    making quick changes to the main page when you don't have any new entries. e.g. use "nb -u main myblog" to just update the
    calendar</li>

    <li>To add an introduction, create a text file in your blog called, "intro.txt". Edit the text file to say what you want,
    then add the following to the main template:
      <pre>
`cat "$BLOG_DIR"/intro.txt`
</pre>Note the use of left single quotes, they're important. Also, note that no processing is being done this way, you have to
add your own HTML.
    </li>

    <li>Many parts of the blog get stored in the <em>parts</em> directory. Say you already have a web site full of your own
    custom server-side scripts/includes. This is where the "parts/news.htm" file comes in. It contains all the current entries,
    so adding a news/diary/blog section is just a matter of adding the code to include "parts/news.htm" into the page. So, now
    you can have a simple blog-like page, that's updated whenever news.htm changes.</li>

    <li>
      <p><b>Adding Comment support to Your Blog</b></p>There's many ways you could accomplish this, but I chose to go with a perl
      based solution, because most web server's already support it. The program I found is called CGIComment [2] and was easy to
      integrate into my blog. The cool thing about CGIComment is it's ability to append comments to any HTML document. Here are
      the steps to enable comments:

      <ul>
        <li>Enable individual entry archiving in <em>blog.conf</em>. Set ENTRY_ARCHIVES to "1".</li>

        <li>Set <em>BLOG_URL_ACTION</em> in <em>blog.conf</em> to "http://myblog.com/cgi-bin/cgicomment.pl?article=".</li>

        <li>Edit <em>templates/entry.htm</em>, add: &lt;a
        href="$BLOG_URL_ACTION$PERMALINKS/$permalink_entry"&gt;Comments&lt;/a&gt;</li>

        <li>Rebuild your blog to reflect the changes. e.g. "nb -b [your_blog_dir] -u all"</li>

        <li>Decompress CGIComment (e.g. tar xzf CGIComment-1.0.tar.gz) one directory above that of your blog.</li>

        <li>Edit <em>cgi-bin/cgicomment.conf</em> and set <em>BASE_DIR</em> to "../cgicomment" and ARTICLEDIR to
        "../[your_blog_dir]".</li>

        <li>Edit <em>cgi-bin/ccadmin.pl</em> and change the default password.</li>

        <li>If necessary, recursively upload the <em>cgi-bin</em> and <em>cgicomment</em> directories one level above your blog
        directory.</li>

        <li>Check that <em>cgicomment</em> and <em>cgi-bin</em> have read and write permissions (e.g. chmod -R 775 cgi-bin
        cgicomment).</li>

        <li>Check that <em>cgicomment.pl</em> and <em>ccadmin.pl</em> are set executable (e.g. chmod 755 ccadmin.pl
        cgicomment.pl).</li>

        <li>If necessary, upload your blog directory.</li>
      </ul>

      <p>When you have comments working you can download my modified set of CGIComment templates[1] that have been designed to
      integrate with NanoBlogger's default stylesheets.</p>
    </li>
  </ul>

  <h2><a name="cr11" id="cr11">Credits</a></h2>Thanks to Adrien "ze" Urban, Paul Drain &lt;pd_at_cipherfunk.org&gt;, Pavel Janik
  &lt;Pavel_at_Janik.cz&gt;, and O.R.Senthil Kumaran &lt;orsenthil_at_users.sourceforge.net&gt; for all the contributions and
  suggestions. Thanks to Bowie J. Poag, author of MicroBlogger [3], for the inspiration of this project.<br />
  <a href="http://home.columbus.rr.com/n1xt3r/downloads/">1. http://home.columbus.rr.com/n1xt3r/downloads/</a><br />
  <a href="http://freshmeat.net/projects/cgicomment/">2. http://freshmeat.net/projects/cgicomment/</a><br />
  <a href="http://freshmeat.net/projects/microblogger">3. http://freshmeat.net/projects/microblogger</a><br />
</body>
</html>
